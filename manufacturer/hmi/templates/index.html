{% extends 'base.html' %}

{% block page_title %}Dashboard{% endblock %}

{% block content %}
<div class="dashboard-container">
  <div class="welcome-section">
    <div class="welcome-header">
      <h2><i class="fas fa-tachometer-alt"></i> SmartLine Manufacturing Dashboard</h2>
      <p class="welcome-subtitle">Real-time industrial control and monitoring system</p>
    </div>
    
    <div class="system-overview">
      <div class="overview-card">
        <div class="card-icon success">
          <i class="fas fa-power-off"></i>
        </div>
        <div class="card-content">
          <h3>System Status</h3>
          <p class="status-text online">Operational</p>
          <small>Last check: 2 minutes ago</small>
        </div>
      </div>
      
      <div class="overview-card">
        <div class="card-icon info">
          <i class="fas fa-microchip"></i>
        </div>
        <div class="card-content">
          <h3>PLC Connection</h3>
          <p class="status-text connected">Connected</p>
          <small>Response time: 12ms</small>
        </div>
      </div>
      
      <div class="overview-card">
        <div class="card-icon warning">
          <i class="fas fa-tasks"></i>
        </div>
        <div class="card-content">
          <h3>Active Orders</h3>
          <p class="status-text count">3</p>
          <small>2 in progress, 1 pending</small>
        </div>
      </div>
      
      <div class="overview-card">
        <div class="card-icon success">
          <i class="fas fa-chart-line"></i>
        </div>
        <div class="card-content">
          <h3>Production Rate</h3>
          <p class="status-text rate">98.5%</p>
          <small>Target: 95%</small>
        </div>
      </div>
    </div>
  </div>

  <div class="dashboard-grid">
    <div class="dashboard-section">
      <div class="section-header">
        <h3><i class="fas fa-cogs"></i> System Metrics</h3>
        <button class="refresh-btn" onclick="refreshMetrics()">
          <i class="fas fa-sync-alt"></i>
        </button>
      </div>
      
      <div class="metrics-grid">
        <div class="metric-item">
          <div class="metric-label">CPU Usage</div>
          <div class="metric-bar">
            <div class="metric-fill cpu" style="width: 45%"></div>
          </div>
          <div class="metric-value">45%</div>
        </div>
        
        <div class="metric-item">
          <div class="metric-label">Memory</div>
          <div class="metric-bar">
            <div class="metric-fill memory" style="width: 67%"></div>
          </div>
          <div class="metric-value">67%</div>
        </div>
        
        <div class="metric-item">
          <div class="metric-label">Network</div>
          <div class="metric-bar">
            <div class="metric-fill network" style="width: 23%"></div>
          </div>
          <div class="metric-value">23%</div>
        </div>
        
        <div class="metric-item">
          <div class="metric-label">Storage</div>
          <div class="metric-bar">
            <div class="metric-fill storage" style="width: 78%"></div>
          </div>
          <div class="metric-value">78%</div>
        </div>
      </div>
    </div>

    <div class="dashboard-section">
      <div class="section-header">
        <h3><i class="fas fa-list-alt"></i> Recent Activity</h3>
        <button class="view-all-btn">View All</button>
      </div>
      
      <div class="activity-list">
        <div class="activity-item">
          <div class="activity-icon success">
            <i class="fas fa-check"></i>
          </div>
          <div class="activity-content">
            <p>Order ORD-2024-001 completed successfully</p>
            <small>2 minutes ago</small>
          </div>
        </div>
        
        <div class="activity-item">
          <div class="activity-icon info">
            <i class="fas fa-upload"></i>
          </div>
          <div class="activity-content">
            <p>New production order uploaded</p>
            <small>15 minutes ago</small>
          </div>
        </div>
        
        <div class="activity-item">
          <div class="activity-icon warning">
            <i class="fas fa-exclamation-triangle"></i>
          </div>
          <div class="activity-content">
            <p>Temperature sensor reading elevated</p>
            <small>1 hour ago</small>
          </div>
        </div>
        
        <div class="activity-item">
          <div class="activity-icon success">
            <i class="fas fa-user"></i>
          </div>
          <div class="activity-content">
            <p>User admin logged in</p>
            <small>2 hours ago</small>
          </div>
        </div>
      </div>
    </div>

    <div class="dashboard-section">
      <div class="section-header">
        <h3><i class="fas fa-thermometer-half"></i> Environmental</h3>
      </div>
      
      <div class="environmental-grid">
        <div class="env-item">
          <div class="env-icon">
            <i class="fas fa-thermometer-half"></i>
          </div>
          <div class="env-data">
            <span class="env-value">23.5°C</span>
            <span class="env-label">Temperature</span>
          </div>
        </div>
        
        <div class="env-item">
          <div class="env-icon">
            <i class="fas fa-tint"></i>
          </div>
          <div class="env-data">
            <span class="env-value">45%</span>
            <span class="env-label">Humidity</span>
          </div>
        </div>
        
        <div class="env-item">
          <div class="env-icon">
            <i class="fas fa-gauge-high"></i>
          </div>
          <div class="env-data">
            <span class="env-value">1013 hPa</span>
            <span class="env-label">Pressure</span>
          </div>
        </div>
      </div>
    </div>

    <div class="dashboard-section quick-actions">
      <div class="section-header">
        <h3><i class="fas fa-bolt"></i> Quick Actions</h3>
      </div>
      
      <div class="actions-grid">
        <a href="/orders" class="action-btn">
          <i class="fas fa-clipboard-list"></i>
          <span>View Orders</span>
        </a>
        
        <a href="/upload" class="action-btn">
          <i class="fas fa-upload"></i>
          <span>Upload Order</span>
        </a>
        
        <button class="action-btn" onclick="exportLogs()">
          <i class="fas fa-download"></i>
          <span>Export Logs</span>
        </button>
        
        <button class="action-btn" onclick="systemDiagnostics()">
          <i class="fas fa-stethoscope"></i>
          <span>Diagnostics</span>
        </button>
      </div>
    </div>
  </div>
</div>

<script>
function refreshMetrics() {
  const refreshBtn = document.querySelector('.refresh-btn i');
  refreshBtn.classList.add('fa-spin');
  
  // Simulate refresh delay
  setTimeout(() => {
    refreshBtn.classList.remove('fa-spin');
    
    // Simulate metric updates with random values
    const metrics = document.querySelectorAll('.metric-fill');
    metrics.forEach(metric => {
      const randomWidth = Math.floor(Math.random() * 80) + 10;
      metric.style.width = randomWidth + '%';
      metric.parentElement.nextElementSibling.textContent = randomWidth + '%';
    });
  }, 1000);
}

function exportLogs() {
  alert('Exporting system logs... (Feature not implemented in demo)');
}

function systemDiagnostics() {
  alert('Running system diagnostics... (Feature not implemented in demo)');
}

// Simulate real-time updates
function updateEnvironmental() {
  const tempElement = document.querySelector('.env-value');
  if (tempElement) {
    const baseTemp = 23.5;
    const variation = (Math.random() - 0.5) * 2;
    const newTemp = (baseTemp + variation).toFixed(1);
    tempElement.textContent = newTemp + '°C';
  }
}

// Update environmental data every 30 seconds
setInterval(updateEnvironmental, 30000);
</script>
{% endblock %}